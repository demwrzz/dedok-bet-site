<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dedok Bet - CoinFlip</title>
    <!-- Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }
        
        .app-container {
            display: flex;
            gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
            height: 90vh;
        }
        
        /* Sol Sidebar - Chat */
        .sidebar {
            width: 350px;
            display: flex;
            flex-direction: column;
        }
        
        /* Ana ƒ∞√ßerik - CoinFlip */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        
        .logo {
            text-align: center;
            margin-bottom: 25px;
        }
        
        .logo h1 {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(90deg, #ff8a00, #e52e71);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }
        
        .logo p {
            font-size: 14px;
            color: #aaa;
            line-height: 1.5;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #ddd;
        }
        
        input[type="text"] {
            width: 100%;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: #fff;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        input[type="text"]:focus {
            outline: none;
            border-color: #e52e71;
            box-shadow: 0 0 0 2px rgba(229, 46, 113, 0.2);
        }
        
        input[type="text"]::placeholder {
            color: #aaa;
        }
        
        .checkbox-group {
            display: flex;
            align-items: flex-start;
            margin-bottom: 20px;
        }
        
        .checkbox-group input {
            margin-right: 10px;
            margin-top: 3px;
        }
        
        .checkbox-group label {
            font-size: 14px;
            color: #ddd;
            line-height: 1.4;
        }
        
        .btn {
            padding: 12px;
            background: linear-gradient(90deg, #ff8a00, #e52e71);
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(229, 46, 113, 0.4);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .step {
            display: none;
        }
        
        .step.active {
            display: block;
        }
        
        .verification-info {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .verification-code {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            margin: 15px 0;
            font-size: 22px;
            font-weight: bold;
            letter-spacing: 2px;
            border: 1px dashed #ff8a00;
        }
        
        .success-message {
            text-align: center;
            padding: 20px;
        }
        
        .success-message h2 {
            color: #4CAF50;
            margin-bottom: 15px;
        }
        
        .error-message {
            color: #f44336;
            font-size: 14px;
            margin-top: 10px;
            display: none;
        }
        
        .back-button {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            margin-bottom: 15px;
        }
        
        .back-button:hover {
            background: rgba(255, 255, 255, 0.2);
            box-shadow: none;
        }
        
        /* CoinFlip Sayfasƒ± Stilleri */
        .coinflip-container {
            display: none;
            height: 100%;
        }
        
        .coinflip-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .coinflip-header h1 {
            font-size: 32px;
            font-weight: 700;
            background: linear-gradient(90deg, #ff8a00, #e52e71);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }
        
        .coinflip-header p {
            color: #aaa;
            margin-bottom: 20px;
        }
        
        .balance-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .balance-card h3 {
            font-size: 18px;
            margin-bottom: 5px;
        }
        
        .balance-amount {
            font-size: 24px;
            font-weight: bold;
            color: #4CAF50;
        }
        
        .profit-amount {
            font-size: 18px;
            font-weight: bold;
            color: #ff8a00;
        }
        
        .matches-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
            flex: 1;
            overflow-y: auto;
            padding: 10px;
        }
        
        .match-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .match-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            border-color: rgba(229, 46, 113, 0.5);
        }
        
        .match-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .match-id {
            font-size: 14px;
            color: #aaa;
        }
        
        .match-pot {
            font-size: 18px;
            font-weight: bold;
            color: #ff8a00;
        }
        
        .players {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        
        .player {
            text-align: center;
            flex: 1;
        }
        
        .player-name {
            font-size: 14px;
            margin-bottom: 5px;
            color: #ddd;
        }
        
        .player-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            margin: 0 auto 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            overflow: hidden;
        }
        
        .player-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .player-bet {
            font-size: 16px;
            font-weight: bold;
        }
        
        .join-btn {
            width: 100%;
            padding: 10px;
            background: linear-gradient(90deg, #4CAF50, #2E7D32);
            border: none;
            border-radius: 5px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .join-btn:disabled {
            background: #666;
            cursor: not-allowed;
        }
        
        .join-btn:hover:not(:disabled) {
            background: linear-gradient(90deg, #66BB6A, #388E3C);
        }
        
        .cancel-btn {
            width: 100%;
            padding: 10px;
            background: linear-gradient(90deg, #f44336, #d32f2f);
            border: none;
            border-radius: 5px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 5px;
        }
        
        .cancel-btn:hover {
            background: linear-gradient(90deg, #ef5350, #e53935);
        }
        
        .create-match {
            margin-top: 20px;
            text-align: center;
        }
        
        .create-btn {
            padding: 12px 30px;
            background: linear-gradient(90deg, #2196F3, #1976D2);
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .create-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(33, 150, 243, 0.4);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .user-welcome {
            font-size: 18px;
        }
        
        .logout-btn {
            padding: 8px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .logout-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        /* Chat Sistemi */
        .chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .chat-header {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            font-weight: 600;
            text-align: center;
        }
        
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
            display: flex;
            flex-direction: column;
        }
        
        .chat-message {
            margin-bottom: 10px;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            max-width: 100%;
            word-wrap: break-word;
        }
        
        .chat-message .sender {
            font-weight: bold;
            color: #ff8a00;
            margin-right: 5px;
        }
        
        .chat-input {
            display: flex;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            gap: 10px;
        }
        
        .chat-input input {
            flex: 1;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            color: white;
        }
        
        .chat-input button {
            padding: 10px 15px;
            background: #4CAF50;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            white-space: nowrap;
        }
        
        /* CoinFlip Animasyonu */
        .coinflip-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            display: none;
        }
        
        .coinflip-content {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            max-width: 500px;
            width: 90%;
        }
        
        .coin {
            width: 150px;
            height: 150px;
            margin: 20px auto;
            position: relative;
            transform-style: preserve-3d;
        }
        
        .coin .front, .coin .back {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            backface-visibility: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            font-weight: bold;
        }
        
        .coin .front {
            background: linear-gradient(45deg, #ff8a00, #e52e71);
        }
        
        .coin .back {
            background: linear-gradient(45deg, #2196F3, #1976D2);
            transform: rotateY(180deg);
        }
        
        .flipping {
            animation: flip 2s ease-in-out;
        }
        
        @keyframes flip {
            0% { transform: rotateY(0); }
            50% { transform: rotateY(1800deg); }
            100% { transform: rotateY(3600deg); }
        }
        
        .result {
            margin-top: 20px;
            font-size: 24px;
            font-weight: bold;
        }
        
        .winner {
            color: #4CAF50;
        }
        
        .loser {
            color: #f44336;
        }
        
        .no-matches {
            text-align: center;
            padding: 30px;
            color: #aaa;
            grid-column: 1 / -1;
        }
        
        /* Envanter Modal */
        .inventory-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            display: none;
        }
        
        .inventory-content {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            max-width: 800px;
            width: 95%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .inventory-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .inventory-header h2 {
            font-size: 24px;
        }
        
        .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
        }
        
        .inventory-items {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
            max-height: 60vh;
            overflow-y: auto;
        }
        
        .inventory-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 10px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }
        
        .inventory-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .inventory-item.selected {
            border-color: #ff8a00;
        }
        
        .item-image {
            width: 60px;
            height: 60px;
            margin: 0 auto 5px;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .item-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .item-name {
            font-weight: bold;
            margin-bottom: 3px;
            font-size: 12px;
        }
        
        .item-value {
            color: #4CAF50;
            font-size: 11px;
        }
        
        .top-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .top-btn {
            padding: 10px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            text-align: center;
        }
        
        .top-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        /* Withdraw Modal */
        .withdraw-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1001;
            display: none;
        }
        
        .withdraw-content {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            max-width: 400px;
            width: 90%;
        }
        
        .withdraw-item {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px 0;
        }
        
        .withdraw-item-image {
            width: 60px;
            height: 60px;
            border-radius: 10px;
            overflow: hidden;
            margin-right: 15px;
        }
        
        .withdraw-item-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .withdraw-item-info {
            text-align: left;
        }
        
        .withdraw-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .withdraw-buttons button {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            font-weight: 600;
        }
        
        .withdraw-confirm {
            background: #4CAF50;
        }
        
        .withdraw-cancel {
            background: #f44336;
        }
        
        /* Create Match Modal */
        .create-match-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            display: none;
        }
        
        .create-match-content {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            max-width: 900px;
            width: 95%;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .selected-items-preview {
            margin: 20px 0;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .selected-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            padding: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
        }
        
        .selected-item img {
            width: 40px;
            height: 40px;
            border-radius: 5px;
            margin-right: 10px;
        }
        
        .selected-item-info {
            flex: 1;
        }
        
        .remove-item {
            background: #f44336;
            border: none;
            color: white;
            border-radius: 3px;
            padding: 5px 10px;
            cursor: pointer;
        }
        
        .no-item-selected {
            text-align: center;
            padding: 20px;
            color: #aaa;
        }
        
        .side-selection {
            margin: 20px 0;
            text-align: center;
        }
        
        .side-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .side-btn {
            flex: 1;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid transparent;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .side-btn.selected {
            border-color: #ff8a00;
            background: rgba(255, 138, 0, 0.2);
        }
        
        .side-btn.heads {
            background: linear-gradient(90deg, #ff8a00, #e52e71);
        }
        
        .side-btn.tails {
            background: linear-gradient(90deg, #2196F3, #1976D2);
        }
        
        .total-value {
            text-align: center;
            margin: 15px 0;
            font-size: 18px;
            font-weight: bold;
            color: #4CAF50;
        }
        
        /* Tip Modal */
        .tip-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1001;
            display: none;
        }
        
        .tip-content {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            max-width: 800px;
            width: 95%;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .tip-form {
            margin: 20px 0;
        }
        
        .tip-form input {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            color: white;
        }
        
        .tip-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .tip-buttons button {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            font-weight: 600;
        }
        
        .tip-confirm {
            background: #4CAF50;
        }

        .tip-confirm:disabled {
            background: #666;
            cursor: not-allowed;
        }
        
        .tip-cancel {
            background: #f44336;
        }
        
        .all-items-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 8px;
            margin-top: 15px;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .quick-tip-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .quick-tip-item:hover {
            transform: translateY(-2px);
            border-color: #ff8a00;
        }
        
        .quick-tip-item.selected {
            border-color: #4CAF50;
        }
        
        .quick-tip-item img {
            width: 40px;
            height: 40px;
            border-radius: 5px;
            margin-bottom: 5px;
        }
        
        .tip-instruction {
            text-align: center;
            color: #aaa;
            font-size: 14px;
            margin: 10px 0;
        }

        /* Baƒülantƒ± Durumu */
        .connection-status {
            position: fixed;
            top: 10px;
            right: 10px;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            z-index: 1000;
        }
        
        .connection-status.connected {
            background: #4CAF50;
            color: white;
        }
        
        .connection-status.disconnected {
            background: #f44336;
            color: white;
        }
        
        /* Search Bar */
        .search-bar {
            margin-bottom: 15px;
        }
        
        .search-bar input {
            width: 100%;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            color: white;
        }
        
        .success-notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #4CAF50;
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            z-index: 1002;
            display: none;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        /* Join Match Modal */
        .join-match-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            display: none;
        }
        
        .join-match-content {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            max-width: 900px;
            width: 95%;
            max-height: 90vh;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <!-- Ba≈üarƒ±lƒ± Bildirim -->
    <div class="success-notification" id="successNotification">Ma√ß ba≈üarƒ±yla olu≈üturuldu!</div>

    <!-- Baƒülantƒ± Durumu -->
    <div class="connection-status disconnected" id="connectionStatus">üî¥ √áevrimdƒ±≈üƒ±</div>

    <!-- Giri≈ü Sayfasƒ± -->
    <div class="container" id="loginContainer" style="max-width: 450px; margin: 50px auto;">
        <div class="logo">
            <h1>Dedok Bet</h1>
            <p>Giri≈ü yaparak, en az 18 ya≈üƒ±nda olduƒüunuzu, bahis yaptƒ±ƒüƒ±nƒ±z √∂ƒüelerin √ßalƒ±ntƒ± olmadƒ±ƒüƒ±nƒ± ve Kullanƒ±m ≈ûartlarƒ±mƒ±zƒ± kabul ettiƒüinizi onaylamƒ±≈ü olursunuz.</p>
        </div>
        
        <!-- Adƒ±m 1: Kullanƒ±cƒ± Adƒ± Giri≈üi -->
        <div class="step active" id="step1">
            <div class="form-group">
                <label for="username">Roblox Kullanƒ±cƒ± Adƒ±</label>
                <input type="text" id="username" placeholder="Roblox kullanƒ±cƒ± adƒ±nƒ±zƒ± girin...">
            </div>
            
            <div class="checkbox-group">
                <input type="checkbox" id="terms">
                <label for="terms">Bu kutuyu i≈üaretleyerek ≈üartlar ve hizmetlerimizi kabul etmi≈ü olursunuz</label>
            </div>
            
            <button class="btn" id="loginBtn">Giri≈ü Yap</button>
            <div class="error-message" id="step1Error"></div>
        </div>
        
        <!-- Adƒ±m 2: Doƒürulama Kodu Giri≈üi -->
        <div class="step" id="step2">
            <button class="btn back-button" id="backBtn">‚Üê Geri</button>
            
            <div class="verification-info">
                <p><strong id="usernameDisplay"></strong> kullanƒ±cƒ± adƒ± i√ßin doƒürulama gerekiyor.</p>
                <p>L√ºtfen a≈üaƒüƒ±daki kodu kopyalayƒ±p Roblox profil a√ßƒ±klamanƒ±za yapƒ±≈ütƒ±rƒ±n:</p>
                <div class="verification-code" id="verificationCodeDisplay">Y√ºkleniyor...</div>
                <p>Kodu a√ßƒ±klamanƒ±za ekledikten sonra a≈üaƒüƒ±daki butona tƒ±klayƒ±n.</p>
            </div>
            
            <button class="btn" id="verifyBtn">Doƒürulamayƒ± Tamamladƒ±m</button>
            <div class="error-message" id="step2Error"></div>
        </div>
    </div>

    <!-- Ana Uygulama -->
    <div class="app-container" id="appContainer" style="display: none;">
        <!-- Sol Sidebar - Chat -->
        <div class="sidebar">
            <div class="container">
                <div class="chat-container">
                    <div class="chat-header">Genel Sohbet</div>
                    <div class="chat-messages" id="chatMessages">
                        <div class="chat-message">
                            <span class="sender">Sistem:</span> Sohbete ho≈ü geldiniz! /tip [kullanƒ±cƒ±] [item] komutu ile item g√∂nderebilirsiniz.
                        </div>
                    </div>
                    <div class="chat-input">
                        <input type="text" id="chatInput" placeholder="Mesajƒ±nƒ±zƒ± yazƒ±n...">
                        <button id="sendMessageBtn">G√∂nder</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ana ƒ∞√ßerik - CoinFlip -->
        <div class="main-content">
            <div class="container coinflip-container" id="coinflipContainer">
                <div class="coinflip-header">
                    <h1>Dedok Bet - CoinFlip</h1>
                    <p>Risk al, kazan√ßlarƒ± topla! %50 ≈üans ile paranƒ± ikiye katla.</p>
                </div>
                
                <div class="user-info">
                    <div class="user-welcome">Ho≈ü geldin, <strong id="coinflipUsername"></strong>!</div>
                    <button class="logout-btn" id="logoutBtn">√áƒ±kƒ±≈ü Yap</button>
                </div>
                
                <div class="top-buttons">
                    <button class="top-btn" id="walletBtn">üí∞ Wallet</button>
                </div>
                
                <div class="balance-card">
                    <div>
                        <h3>Toplam Value</h3>
                        <div class="balance-amount" id="userBalance">0 Value</div>
                        <div class="profit-amount" id="userProfit">+0 Profit</div>
                    </div>
                </div>
                
                <h2 style="margin-bottom: 15px;">Aktif Ma√ßlar</h2>
                <div class="matches-container" id="matchesContainer">
                    <div class="no-matches" id="noMatchesMessage">
                        Hen√ºz aktif ma√ß bulunmuyor. ƒ∞lk ma√ßƒ± siz olu≈üturun!
                    </div>
                </div>
                
                <div class="create-match">
                    <button class="create-btn" id="createMatchBtn">Yeni Ma√ß Olu≈ütur</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal'lar -->
    <!-- CoinFlip Animasyon Modal -->
    <div class="coinflip-modal" id="coinflipModal">
        <div class="coinflip-content">
            <h2>CoinFlip</h2>
            <div class="coin" id="coin">
                <div class="front">HEADS</div>
                <div class="back">TAILS</div>
            </div>
            <div class="result" id="coinflipResult"></div>
            <button class="btn" id="closeModalBtn" style="margin-top: 20px;">Kapat</button>
        </div>
    </div>

    <!-- Envanter Modal -->
    <div class="inventory-modal" id="inventoryModal">
        <div class="inventory-content">
            <div class="inventory-header">
                <h2>Envanterim</h2>
                <button class="close-btn" id="closeInventoryBtn">√ó</button>
            </div>
            <div class="inventory-items" id="inventoryItems">
                <!-- Itemler buraya eklenecek -->
            </div>
        </div>
    </div>

    <!-- Ma√ßa Katƒ±lma Modal -->
    <div class="join-match-modal" id="joinMatchModal">
        <div class="join-match-content">
            <div class="inventory-header">
                <h2>Ma√ßa Katƒ±l - Item Se√ßin</h2>
                <button class="close-btn" id="closeJoinMatchBtn">√ó</button>
            </div>
            
            <div class="search-bar">
                <input type="text" id="joinItemSearch" placeholder="Item ara...">
            </div>
            
            <div class="selected-items-preview" id="joinSelectedItemsPreview">
                <div class="no-item-selected">Hen√ºz item se√ßilmedi</div>
            </div>
            
            <div class="total-value" id="joinTotalValue">Toplam Value: 0</div>
            
            <div class="side-selection">
                <h3>Kar≈üƒ± Tarafƒ±n Se√ßimi: <span id="opponentSide"></span></h3>
                <div class="side-buttons">
                    <button class="side-btn heads" data-side="heads">HEADS</button>
                    <button class="side-btn tails" data-side="tails">TAILS</button>
                </div>
            </div>
            
            <div class="inventory-items" id="joinMatchItems">
                <!-- Itemler buraya eklenecek -->
            </div>
            
            <button class="btn" id="confirmJoinMatchBtn" style="margin-top: 20px;" disabled>Ma√ßa Katƒ±l</button>
        </div>
    </div>

    <!-- Create Match Modal -->
    <div class="create-match-modal" id="createMatchModal">
        <div class="create-match-content">
            <div class="inventory-header">
                <h2>Ma√ß ƒ∞√ßin Item Se√ßin</h2>
                <button class="close-btn" id="closeCreateMatchBtn">√ó</button>
            </div>
            
            <div class="search-bar">
                <input type="text" id="itemSearch" placeholder="Item ara...">
            </div>
            
            <div class="selected-items-preview" id="selectedItemsPreview">
                <div class="no-item-selected">Hen√ºz item se√ßilmedi</div>
            </div>
            
            <div class="total-value" id="totalMatchValue">Toplam Value: 0</div>
            
            <div class="side-selection">
                <h3>Heads or Tails Se√ßin</h3>
                <div class="side-buttons">
                    <button class="side-btn heads" data-side="heads">HEADS</button>
                    <button class="side-btn tails" data-side="tails">TAILS</button>
                </div>
            </div>
            
            <div class="inventory-items" id="createMatchItems">
                <!-- Itemler buraya eklenecek -->
            </div>
            
            <button class="btn" id="confirmCreateMatchBtn" style="margin-top: 20px;" disabled>Ma√ßƒ± Olu≈ütur</button>
        </div>
    </div>

    <script>
        // SUPABASE AYARLARI
        const SUPABASE_URL = 'https://vkuhfhjibegquqatxmyt.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZrdWhmaGppYmVncXVxYXR4bXl0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQzNDEwNzMsImV4cCI6MjA3OTkxNzA3M30.1Ir2Hy43qw6ey59gGytr8Jo3OKUC9y5pt8Jwj76PPPc';

        // Supabase baƒülantƒ±sƒ±
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // DOM Elementleri
        const loginContainer = document.getElementById('loginContainer');
        const appContainer = document.getElementById('appContainer');
        const coinflipContainer = document.getElementById('coinflipContainer');
        const step1 = document.getElementById('step1');
        const step2 = document.getElementById('step2');
        const usernameInput = document.getElementById('username');
        const termsCheckbox = document.getElementById('terms');
        const loginBtn = document.getElementById('loginBtn');
        const backBtn = document.getElementById('backBtn');
        const usernameDisplay = document.getElementById('usernameDisplay');
        const verificationCodeDisplay = document.getElementById('verificationCodeDisplay');
        const verifyBtn = document.getElementById('verifyBtn');
        const coinflipUsername = document.getElementById('coinflipUsername');
        const step1Error = document.getElementById('step1Error');
        const step2Error = document.getElementById('step2Error');
        const matchesContainer = document.getElementById('matchesContainer');
        const noMatchesMessage = document.getElementById('noMatchesMessage');
        const logoutBtn = document.getElementById('logoutBtn');
        const createMatchBtn = document.getElementById('createMatchBtn');
        const userBalance = document.getElementById('userBalance');
        const userProfit = document.getElementById('userProfit');
        const successNotification = document.getElementById('successNotification');
        const coinflipModal = document.getElementById('coinflipModal');
        const coin = document.getElementById('coin');
        const coinflipResult = document.getElementById('coinflipResult');
        const closeModalBtn = document.getElementById('closeModalBtn');
        
        // Create Match Modal Elements
        const createMatchModal = document.getElementById('createMatchModal');
        const closeCreateMatchBtn = document.getElementById('closeCreateMatchBtn');
        const createMatchItems = document.getElementById('createMatchItems');
        const selectedItemsPreview = document.getElementById('selectedItemsPreview');
        const confirmCreateMatchBtn = document.getElementById('confirmCreateMatchBtn');
        const totalMatchValue = document.getElementById('totalMatchValue');
        const itemSearch = document.getElementById('itemSearch');
        
        // Join Match Modal Elements
        const joinMatchModal = document.getElementById('joinMatchModal');
        const closeJoinMatchBtn = document.getElementById('closeJoinMatchBtn');
        const joinMatchItems = document.getElementById('joinMatchItems');
        const joinSelectedItemsPreview = document.getElementById('joinSelectedItemsPreview');
        const confirmJoinMatchBtn = document.getElementById('confirmJoinMatchBtn');
        const joinTotalValue = document.getElementById('joinTotalValue');
        const joinItemSearch = document.getElementById('joinItemSearch');
        const opponentSide = document.getElementById('opponentSide');
        
        // Deƒüi≈ükenler
        let currentUser = null;
        let verificationCode = '';
        let activeMatches = [];
        let userInventory = [];
        let selectedItemsForMatch = [];
        let selectedSideForMatch = null;
        let selectedItemsForJoin = [];
        let selectedSideForJoin = null;
        let totalProfit = 0;
        let currentMatchId = null;

        // Item tanƒ±mlarƒ±
        const items = [
            {
                id: 1,
                name: "Corrupt",
                value: 825,
                image: "https://tr.rbxcdn.com/180DAY-f3a3fda528c91ef9357361df1c14d5fb/420/420/Model/Png/noFilter"
            },
            {
                id: 2,
                name: "C Vampires Gun",
                value: 23000,
                image: "https://tr.rbxcdn.com/180DAY-7ecc9d172ad05caf211e515471893d29/420/420/Image/Png/noFilter"
            },
            {
                id: 3,
                name: "Travellers Gun",
                value: 4100,
                image: "https://tr.rbxcdn.com/180DAY-950f9412ff516bbea7459c4ba504d4a2/420/420/Model/Png/noFilter"
            },
            {
                id: 4,
                name: "Evergun",
                value: 3000,
                image: "https://tr.rbxcdn.com/180DAY-50bb023f54e8dbae44aa4b02d61ce050/420/420/Image/Png/noFilter"
            },
            {
                id: 5,
                name: "Sugar",
                value: 70,
                image: "https://tr.rbxcdn.com/180DAY-fc538eca64fbe088a13c8ce66e47a0a2/420/420/Image/Png/noFilter"
            },
            {
                id: 6,
                name: "Vampires Gun",
                value: 2000,
                image: "https://tr.rbxcdn.com/180DAY-a132d04b779839721744cd1f31c2ec39/420/420/Model/Png/noFilter"
            },
            {
                id: 7,
                name: "Harvester",
                value: 450,
                image: "https://tr.rbxcdn.com/180DAY-67a3a4b144ccf57f1bbdafe8fa27a08a/420/420/Model/Png/noFilter"
            },
            {
                id: 8,
                name: "Sakura",
                value: 895,
                image: "https://tr.rbxcdn.com/180DAY-f1d1285a9c3c4de680df8a5ae9fe2af9/420/420/Model/Png/noFilter"
            },
            {
                id: 9,
                name: "Icepiercer",
                value: 325,
                image: "https://tr.rbxcdn.com/180DAY-6213a4bb141ead4f941b11a0f93fd44a/420/420/Model/Png/noFilter"
            },
            {
                id: 10,
                name: "Chroma Saw",
                value: 40,
                image: "https://tr.rbxcdn.com/180DAY-ffd5ea6a2617d24536ff6adf87c0bbd1/420/420/Image/Png/noFilter"
            },
            {
                id: 11,
                name: "Candy",
                value: 170,
                image: "https://tr.rbxcdn.com/180DAY-2007a4c9c774eb21534ed011ae6e36b2/420/420/Model/Png/noFilter"
            },
            {
                id: 12,
                name: "Chroma Gemstone",
                value: 45,
                image: "https://tr.rbxcdn.com/180DAY-cd9724ce67d6854fdd9dc219eb3e0ac2/420/420/Image/Png/noFilter"
            },
            {
                id: 13,
                name: "Chroma Heat",
                value: 45,
                image: "https://tr.rbxcdn.com/180DAY-292d5d05d6c42cb1f413b2b8ab2be5e1/420/420/Image/Png/noFilter"
            },
            {
                id: 14,
                name: "Chroma Seer",
                value: 45,
                image: "https://tr.rbxcdn.com/180DAY-468b0f806c05652ed9b7a3a09a45edc0/420/420/Image/Png/noFilter"
            },
            {
                id: 15,
                name: "Chroma Boneblade",
                value: 40,
                image: "https://tr.rbxcdn.com/180DAY-c0b2f2255317bee86c95e70626ee2aa5/420/420/Model/Png/noFilter"
            },
            {
                id: 16,
                name: "Rainbow Gun",
                value: 250,
                image: "https://tr.rbxcdn.com/180DAY-4644f803d4c1171db843b608d8692354/420/420/Model/Png/noFilter"
            },
            {
                id: 17,
                name: "Flowerwood Gun",
                value: 150,
                image: "https://tr.rbxcdn.com/180DAY-d321727e99eb67e54c746a2c310b0472/420/420/Model/Png/noFilter"
            }
        ];

        // Sayfa y√ºklendiƒüinde oturum kontrol√º
        document.addEventListener('DOMContentLoaded', async function() {
            const savedUser = localStorage.getItem('currentUser');
            const savedProfit = localStorage.getItem('totalProfit');
            
            if (savedUser) {
                currentUser = savedUser;
                userInventory = JSON.parse(localStorage.getItem('userInventory')) || [];
                totalProfit = savedProfit ? parseInt(savedProfit) : 0;
                
                if (userInventory.length === 0) {
                    userInventory = [...items];
                    localStorage.setItem('userInventory', JSON.stringify(userInventory));
                }
                
                await showMainApp();
            }
        });

        // Giri≈ü butonu tƒ±klama olayƒ±
        loginBtn.addEventListener('click', function() {
            const username = usernameInput.value.trim();
            
            if (!username) {
                showError(step1Error, "L√ºtfen Roblox kullanƒ±cƒ± adƒ±nƒ±zƒ± girin.");
                return;
            }
            
            if (!termsCheckbox.checked) {
                showError(step1Error, "Devam etmek i√ßin ≈üartlarƒ± kabul etmelisiniz.");
                return;
            }
            
            hideError(step1Error);
            usernameDisplay.textContent = username;
            generateVerificationCode();
            showStep(2);
        });
        
        function generateVerificationCode() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let code = '';
            for (let i = 0; i < 8; i++) {
                code += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            verificationCode = code;
            verificationCodeDisplay.textContent = code;
        }
        
        backBtn.addEventListener('click', function() {
            showStep(1);
        });
        
        verifyBtn.addEventListener('click', async function() {
            hideError(step2Error);
            currentUser = usernameInput.value.trim();
            userInventory = [...items];
            totalProfit = 0;
            
            localStorage.setItem('currentUser', currentUser);
            localStorage.setItem('userInventory', JSON.stringify(userInventory));
            localStorage.setItem('totalProfit', totalProfit.toString());
            
            await showMainApp();
        });

        // Ana uygulamayƒ± g√∂ster
        async function showMainApp() {
            loginContainer.style.display = 'none';
            appContainer.style.display = 'flex';
            coinflipContainer.style.display = 'flex';
            coinflipUsername.textContent = currentUser;
            
            updateTotalValue();
            updateProfitDisplay();
            loadActiveMatches();
            
            // Real-time dinleyiciyi ba≈ülat
            initializeRealtimeListener();
            
            connectionStatus.textContent = 'üü¢ √áevrimi√ßi';
            connectionStatus.className = 'connection-status connected';
        }

        // Real-time dinleyici
        function initializeRealtimeListener() {
            // Ma√ßlar i√ßin real-time dinleyici
            supabase
                .channel('public:matches')
                .on('postgres_changes', 
                    { 
                        event: '*', 
                        schema: 'public', 
                        table: 'matches' 
                    }, 
                    (payload) => {
                        console.log('Ma√ß deƒüi≈üikliƒüi:', payload);
                        loadActiveMatches();
                    }
                )
                .subscribe();
        }

        // Aktif ma√ßlarƒ± y√ºkle
        async function loadActiveMatches() {
            // Demo ma√ßlar - ger√ßek uygulamada Supabase'den √ßekilecek
            activeMatches = [
                {
                    id: 1,
                    creator: "Player1",
                    player2: null,
                    items: [items[0], items[1]],
                    player2_items: null,
                    side: "heads",
                    totalValue: 23825,
                    pot: 47650,
                    status: 'waiting'
                },
                {
                    id: 2,
                    creator: "Player2", 
                    player2: null,
                    items: [items[2], items[3]],
                    player2_items: null,
                    side: "tails",
                    totalValue: 7100,
                    pot: 14200,
                    status: 'waiting'
                }
            ];
            
            updateMatchesDisplay();
        }

        // Ma√ßlarƒ± g√∂ster
        function updateMatchesDisplay() {
            matchesContainer.innerHTML = '';
            
            if (activeMatches.length === 0) {
                noMatchesMessage.style.display = 'block';
                return;
            }
            
            noMatchesMessage.style.display = 'none';
            
            activeMatches.forEach(match => {
                const matchCard = document.createElement('div');
                matchCard.className = 'match-card';
                
                const totalValue = match.items.reduce((sum, item) => sum + item.value, 0);
                const isMyMatch = match.creator === currentUser;
                const isFull = match.player2 !== null;
                
                matchCard.innerHTML = `
                    <div class="match-header">
                        <div class="match-id">Ma√ß #${match.id}</div>
                        <div class="match-pot">${totalValue * 2} Value</div>
                    </div>
                    <div class="players">
                        <div class="player">
                            <div class="player-name">${match.creator}</div>
                            <div class="player-avatar">${match.creator.charAt(0)}</div>
                            <div class="player-bet">${totalValue} Value</div>
                        </div>
                        <div class="player">
                            <div class="player-name">${match.player2 || 'Bekleniyor'}</div>
                            <div class="player-avatar">${match.player2 ? match.player2.charAt(0) : '?'}</div>
                            <div class="player-bet">${match.player2 ? (match.player2_items ? match.player2_items.reduce((sum, item) => sum + item.value, 0) : 0) + ' Value' : ''}</div>
                        </div>
                    </div>
                    <button class="join-btn" ${isMyMatch || isFull ? 'disabled' : ''}>
                        ${isMyMatch ? 'Sizin Ma√ßƒ±nƒ±z' : (isFull ? 'Ma√ß Dolu' : 'Katƒ±l')}
                    </button>
                `;
                
                const joinBtn = matchCard.querySelector('.join-btn');
                if (!joinBtn.disabled) {
                    joinBtn.addEventListener('click', () => joinMatch(match.id));
                }
                
                matchesContainer.appendChild(matchCard);
            });
        }

        // Ma√ßa katƒ±l
        function joinMatch(matchId) {
            const match = activeMatches.find(m => m.id === matchId);
            if (!match) return;
            
            currentMatchId = matchId;
            selectedItemsForJoin = [];
            selectedSideForJoin = null;
            opponentSide.textContent = match.side.toUpperCase();
            updateJoinMatchPreview();
            loadInventoryForJoinMatch();
            joinMatchModal.style.display = 'flex';
        }

        // Ma√ßa katƒ±lma modalƒ±nƒ± y√ºkle
        function loadInventoryForJoinMatch() {
            renderFilteredItemsForJoinMatch(userInventory);
            joinItemSearch.value = '';
        }

        function renderFilteredItemsForJoinMatch(filteredItems) {
            joinMatchItems.innerHTML = '';
            
            if (filteredItems.length === 0) {
                joinMatchItems.innerHTML = '<div style="text-align: center; padding: 20px; color: #aaa;">Item bulunamadƒ±</div>';
                return;
            }
            
            filteredItems.forEach(item => {
                const isSelected = selectedItemsForJoin.some(selected => selected.id === item.id);
                const itemElement = document.createElement('div');
                itemElement.className = `inventory-item ${isSelected ? 'selected' : ''}`;
                itemElement.innerHTML = `
                    <div class="item-image">
                        <img src="${item.image}" alt="${item.name}" onerror="this.src='https://via.placeholder.com/60x60/333/fff?text=?'">
                    </div>
                    <div class="item-name">${item.name}</div>
                    <div class="item-value">${item.value} Value</div>
                `;
                
                itemElement.addEventListener('click', () => {
                    if (isSelected) {
                        selectedItemsForJoin = selectedItemsForJoin.filter(selected => selected.id !== item.id);
                        itemElement.classList.remove('selected');
                    } else {
                        selectedItemsForJoin.push(item);
                        itemElement.classList.add('selected');
                    }
                    updateJoinMatchPreview();
                });
                
                joinMatchItems.appendChild(itemElement);
            });
        }

        function updateJoinMatchPreview() {
            joinSelectedItemsPreview.innerHTML = '';
            
            if (selectedItemsForJoin.length === 0) {
                joinSelectedItemsPreview.innerHTML = '<div class="no-item-selected">Hen√ºz item se√ßilmedi</div>';
                joinTotalValue.textContent = 'Toplam Value: 0';
                confirmJoinMatchBtn.disabled = true;
                return;
            }
            
            let totalValue = 0;
            selectedItemsForJoin.forEach(item => {
                totalValue += item.value;
                
                const selectedItem = document.createElement('div');
                selectedItem.className = 'selected-item';
                selectedItem.innerHTML = `
                    <img src="${item.image}" alt="${item.name}" onerror="this.src='https://via.placeholder.com/40x40/333/fff?text=?'">
                    <div class="selected-item-info">
                        <div>${item.name}</div>
                        <div style="color: #4CAF50; font-size: 12px;">${item.value} Value</div>
                    </div>
                    <button class="remove-item" data-id="${item.id}">√ó</button>
                `;
                
                joinSelectedItemsPreview.appendChild(selectedItem);
            });
            
            joinTotalValue.textContent = `Toplam Value: ${totalValue}`;
            confirmJoinMatchBtn.disabled = !selectedSideForJoin;
            
            joinSelectedItemsPreview.querySelectorAll('.remove-item').forEach(btn => {
                btn.addEventListener('click', function() {
                    const itemId = parseInt(this.getAttribute('data-id'));
                    selectedItemsForJoin = selectedItemsForJoin.filter(item => item.id !== itemId);
                    updateJoinMatchPreview();
                    loadInventoryForJoinMatch();
                });
            });
        }

        // Join match side selection
        joinMatchModal.querySelectorAll('.side-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                joinMatchModal.querySelectorAll('.side-btn').forEach(b => b.classList.remove('selected'));
                this.classList.add('selected');
                selectedSideForJoin = this.getAttribute('data-side');
                confirmJoinMatchBtn.disabled = selectedItemsForJoin.length === 0;
            });
        });

        // Ma√ßa katƒ±lma onayƒ±
        confirmJoinMatchBtn.addEventListener('click', function() {
            if (selectedItemsForJoin.length > 0 && selectedSideForJoin) {
                // CoinFlip animasyonunu ba≈ülat
                startCoinFlipAnimation(currentMatchId, selectedSideForJoin);
                joinMatchModal.style.display = 'none';
            }
        });

        // CoinFlip animasyonu
        function startCoinFlipAnimation(matchId, playerSide) {
            const match = activeMatches.find(m => m.id === matchId);
            if (!match) return;
            
            const opponentSide = match.side;
            const winner = Math.random() > 0.5 ? 'heads' : 'tails';
            const isWinner = playerSide === winner;
            
            // Animasyonu ba≈ülat
            coin.classList.add('flipping');
            coinflipModal.style.display = 'flex';
            
            setTimeout(() => {
                coin.classList.remove('flipping');
                
                if (isWinner) {
                    coinflipResult.innerHTML = `<span class="winner">üéâ KAZANDIN! üéâ</span>`;
                    // Kazananƒ±n √∂d√ºl√º
                    const totalWinnings = match.items.reduce((sum, item) => sum + item.value, 0) + 
                                         selectedItemsForJoin.reduce((sum, item) => sum + item.value, 0);
                    totalProfit += totalWinnings;
                    // Kazanan itemleri alƒ±r
                    userInventory = [...userInventory, ...match.items];
                } else {
                    coinflipResult.innerHTML = `<span class="loser">üòû KAYBETTƒ∞N!</span>`;
                    // Kaybeden itemlerini kaybeder
                    selectedItemsForJoin.forEach(item => {
                        userInventory = userInventory.filter(invItem => invItem.id !== item.id);
                    });
                    totalProfit -= selectedItemsForJoin.reduce((sum, item) => sum + item.value, 0);
                }
                
                localStorage.setItem('userInventory', JSON.stringify(userInventory));
                localStorage.setItem('totalProfit', totalProfit.toString());
                updateTotalValue();
                updateProfitDisplay();
                
                // Ma√ßƒ± listeden kaldƒ±r
                activeMatches = activeMatches.filter(m => m.id !== matchId);
                updateMatchesDisplay();
                
            }, 2000);
        }

        closeModalBtn.addEventListener('click', function() {
            coinflipModal.style.display = 'none';
        });

        closeJoinMatchBtn.addEventListener('click', function() {
            joinMatchModal.style.display = 'none';
        });

        // Item arama (join match)
        joinItemSearch.addEventListener('input', function() {
            const filteredItems = userInventory.filter(item => 
                item.name.toLowerCase().includes(this.value.toLowerCase())
            );
            renderFilteredItemsForJoinMatch(filteredItems);
        });

        // Toplam value'yi g√ºncelle
        function updateTotalValue() {
            const total = userInventory.reduce((sum, item) => sum + item.value, 0);
            userBalance.textContent = total + ' Value';
        }

        // Profit g√∂sterimini g√ºncelle
        function updateProfitDisplay() {
            const profitText = totalProfit >= 0 ? `+${totalProfit} Profit` : `${totalProfit} Profit`;
            const profitColor = totalProfit >= 0 ? '#4CAF50' : '#f44336';
            userProfit.textContent = profitText;
            userProfit.style.color = profitColor;
        }

        // Ba≈üarƒ±lƒ± bildirim g√∂ster
        function showSuccessNotification(message) {
            successNotification.textContent = message;
            successNotification.style.display = 'block';
            setTimeout(() => {
                successNotification.style.display = 'none';
            }, 3000);
        }

        // Ma√ß olu≈üturma modalƒ±nƒ± a√ß
        createMatchBtn.addEventListener('click', function() {
            selectedItemsForMatch = [];
            selectedSideForMatch = null;
            updateCreateMatchPreview();
            loadInventoryForMatchCreation();
            createMatchModal.style.display = 'flex';
        });

        // Item arama
        itemSearch.addEventListener('input', function() {
            filterItemsForMatchCreation(this.value);
        });

        function filterItemsForMatchCreation(searchTerm) {
            const filteredItems = userInventory.filter(item => 
                item.name.toLowerCase().includes(searchTerm.toLowerCase())
            );
            renderFilteredItemsForMatchCreation(filteredItems);
        }

        function renderFilteredItemsForMatchCreation(filteredItems) {
            createMatchItems.innerHTML = '';
            
            if (filteredItems.length === 0) {
                createMatchItems.innerHTML = '<div style="text-align: center; padding: 20px; color: #aaa;">Item bulunamadƒ±</div>';
                return;
            }
            
            filteredItems.forEach(item => {
                const isSelected = selectedItemsForMatch.some(selected => selected.id === item.id);
                const itemElement = document.createElement('div');
                itemElement.className = `inventory-item ${isSelected ? 'selected' : ''}`;
                itemElement.innerHTML = `
                    <div class="item-image">
                        <img src="${item.image}" alt="${item.name}" onerror="this.src='https://via.placeholder.com/60x60/333/fff?text=?'">
                    </div>
                    <div class="item-name">${item.name}</div>
                    <div class="item-value">${item.value} Value</div>
                `;
                
                itemElement.addEventListener('click', () => {
                    if (isSelected) {
                        selectedItemsForMatch = selectedItemsForMatch.filter(selected => selected.id !== item.id);
                        itemElement.classList.remove('selected');
                    } else {
                        selectedItemsForMatch.push(item);
                        itemElement.classList.add('selected');
                    }
                    updateCreateMatchPreview();
                });
                
                createMatchItems.appendChild(itemElement);
            });
        }

        function loadInventoryForMatchCreation() {
            renderFilteredItemsForMatchCreation(userInventory);
            itemSearch.value = '';
        }

        function updateCreateMatchPreview() {
            selectedItemsPreview.innerHTML = '';
            
            if (selectedItemsForMatch.length === 0) {
                selectedItemsPreview.innerHTML = '<div class="no-item-selected">Hen√ºz item se√ßilmedi</div>';
                totalMatchValue.textContent = 'Toplam Value: 0';
                confirmCreateMatchBtn.disabled = true;
                return;
            }
            
            let totalValue = 0;
            selectedItemsForMatch.forEach(item => {
                totalValue += item.value;
                
                const selectedItem = document.createElement('div');
                selectedItem.className = 'selected-item';
                selectedItem.innerHTML = `
                    <img src="${item.image}" alt="${item.name}" onerror="this.src='https://via.placeholder.com/40x40/333/fff?text=?'">
                    <div class="selected-item-info">
                        <div>${item.name}</div>
                        <div style="color: #4CAF50; font-size: 12px;">${item.value} Value</div>
                    </div>
                    <button class="remove-item" data-id="${item.id}">√ó</button>
                `;
                
                selectedItemsPreview.appendChild(selectedItem);
            });
            
            totalMatchValue.textContent = `Toplam Value: ${totalValue}`;
            confirmCreateMatchBtn.disabled = !selectedSideForMatch;
            
            selectedItemsPreview.querySelectorAll('.remove-item').forEach(btn => {
                btn.addEventListener('click', function() {
                    const itemId = parseInt(this.getAttribute('data-id'));
                    selectedItemsForMatch = selectedItemsForMatch.filter(item => item.id !== itemId);
                    updateCreateMatchPreview();
                    loadInventoryForMatchCreation();
                });
            });
        }

        // Side se√ßimi
        document.querySelectorAll('.side-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                // Sadece create match modalƒ±ndaki butonlarƒ± etkile
                if (this.closest('#createMatchModal')) {
                    document.querySelectorAll('#createMatchModal .side-btn').forEach(b => b.classList.remove('selected'));
                    this.classList.add('selected');
                    selectedSideForMatch = this.getAttribute('data-side');
                    confirmCreateMatchBtn.disabled = selectedItemsForMatch.length === 0;
                }
            });
        });

        // Ma√ß olu≈üturma onayƒ±
        confirmCreateMatchBtn.addEventListener('click', async function() {
            if (selectedItemsForMatch.length > 0 && selectedSideForMatch) {
                const totalValue = selectedItemsForMatch.reduce((total, item) => total + item.value, 0);
                
                // Yeni ma√ß olu≈ütur
                const newMatch = {
                    id: Date.now(), // Basit ID olu≈üturma
                    creator: currentUser,
                    player2: null,
                    items: [...selectedItemsForMatch],
                    player2_items: null,
                    side: selectedSideForMatch,
                    totalValue: totalValue,
                    pot: totalValue * 2,
                    status: 'waiting'
                };
                
                activeMatches.push(newMatch);
                
                // Se√ßilen itemleri envanterden kaldƒ±r
                selectedItemsForMatch.forEach(item => {
                    userInventory = userInventory.filter(invItem => invItem.id !== item.id);
                });
                
                localStorage.setItem('userInventory', JSON.stringify(userInventory));
                updateTotalValue();
                
                showSuccessNotification("Ma√ß ba≈üarƒ±yla olu≈üturuldu!");
                createMatchModal.style.display = 'none';
                updateMatchesDisplay();
                
                // Modal kapandƒ±ktan sonra se√ßimleri sƒ±fƒ±rla
                setTimeout(() => {
                    selectedItemsForMatch = [];
                    selectedSideForMatch = null;
                }, 500);
            }
        });

        closeCreateMatchBtn.addEventListener('click', function() {
            createMatchModal.style.display = 'none';
        });

        // Diƒüer fonksiyonlar...
        function showStep(stepNumber) {
            document.querySelectorAll('.step').forEach(step => {
                step.classList.remove('active');
            });
            document.getElementById('step' + stepNumber).classList.add('active');
        }

        function showError(errorElement, message) {
            errorElement.textContent = message;
            errorElement.style.display = 'block';
        }

        function hideError(errorElement) {
            errorElement.style.display = 'none';
        }

        // √áƒ±kƒ±≈ü butonu
        logoutBtn.addEventListener('click', function() {
            localStorage.removeItem('currentUser');
            localStorage.removeItem('userInventory');
            localStorage.removeItem('totalProfit');
            appContainer.style.display = 'none';
            loginContainer.style.display = 'block';
            showStep(1);
            usernameInput.value = '';
            termsCheckbox.checked = false;
            currentUser = null;
            userInventory = [];
            totalProfit = 0;
            activeMatches = [];
        });
    </script>
</body>
</html>
