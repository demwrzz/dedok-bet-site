<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dedok Bet - CoinFlip</title>
    <!-- Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }
        
        .app-container {
            display: flex;
            gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
            height: 90vh;
        }
        
        /* Sol Sidebar - Chat */
        .sidebar {
            width: 350px;
            display: flex;
            flex-direction: column;
        }
        
        /* Ana ƒ∞√ßerik - CoinFlip */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        
        .logo {
            text-align: center;
            margin-bottom: 25px;
        }
        
        .logo h1 {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(90deg, #ff8a00, #e52e71);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }
        
        .logo p {
            font-size: 14px;
            color: #aaa;
            line-height: 1.5;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #ddd;
        }
        
        input[type="text"] {
            width: 100%;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: #fff;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        input[type="text"]:focus {
            outline: none;
            border-color: #e52e71;
            box-shadow: 0 0 0 2px rgba(229, 46, 113, 0.2);
        }
        
        input[type="text"]::placeholder {
            color: #aaa;
        }
        
        .checkbox-group {
            display: flex;
            align-items: flex-start;
            margin-bottom: 20px;
        }
        
        .checkbox-group input {
            margin-right: 10px;
            margin-top: 3px;
        }
        
        .checkbox-group label {
            font-size: 14px;
            color: #ddd;
            line-height: 1.4;
        }
        
        .btn {
            padding: 12px;
            background: linear-gradient(90deg, #ff8a00, #e52e71);
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(229, 46, 113, 0.4);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .step {
            display: none;
        }
        
        .step.active {
            display: block;
        }
        
        .verification-info {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .verification-code {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            margin: 15px 0;
            font-size: 22px;
            font-weight: bold;
            letter-spacing: 2px;
            border: 1px dashed #ff8a00;
        }
        
        .success-message {
            text-align: center;
            padding: 20px;
        }
        
        .success-message h2 {
            color: #4CAF50;
            margin-bottom: 15px;
        }
        
        .error-message {
            color: #f44336;
            font-size: 14px;
            margin-top: 10px;
            display: none;
        }
        
        .back-button {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            margin-bottom: 15px;
        }
        
        .back-button:hover {
            background: rgba(255, 255, 255, 0.2);
            box-shadow: none;
        }
        
        /* CoinFlip Sayfasƒ± Stilleri */
        .coinflip-container {
            display: none;
            height: 100%;
        }
        
        .coinflip-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .coinflip-header h1 {
            font-size: 32px;
            font-weight: 700;
            background: linear-gradient(90deg, #ff8a00, #e52e71);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }
        
        .coinflip-header p {
            color: #aaa;
            margin-bottom: 20px;
        }
        
        .balance-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .balance-card h3 {
            font-size: 18px;
            margin-bottom: 5px;
        }
        
        .balance-amount {
            font-size: 24px;
            font-weight: bold;
            color: #4CAF50;
        }
        
        .matches-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
            flex: 1;
            overflow-y: auto;
            padding: 10px;
        }
        
        .match-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .match-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            border-color: rgba(229, 46, 113, 0.5);
        }
        
        .match-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .match-id {
            font-size: 14px;
            color: #aaa;
        }
        
        .match-pot {
            font-size: 18px;
            font-weight: bold;
            color: #ff8a00;
        }
        
        .players {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        
        .player {
            text-align: center;
            flex: 1;
        }
        
        .player-name {
            font-size: 14px;
            margin-bottom: 5px;
            color: #ddd;
        }
        
        .player-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            margin: 0 auto 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            overflow: hidden;
        }
        
        .player-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .player-bet {
            font-size: 16px;
            font-weight: bold;
        }
        
        .join-btn {
            width: 100%;
            padding: 10px;
            background: linear-gradient(90deg, #4CAF50, #2E7D32);
            border: none;
            border-radius: 5px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .join-btn:disabled {
            background: #666;
            cursor: not-allowed;
        }
        
        .join-btn:hover:not(:disabled) {
            background: linear-gradient(90deg, #66BB6A, #388E3C);
        }
        
        .cancel-btn {
            width: 100%;
            padding: 10px;
            background: linear-gradient(90deg, #f44336, #d32f2f);
            border: none;
            border-radius: 5px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 5px;
        }
        
        .cancel-btn:hover {
            background: linear-gradient(90deg, #ef5350, #e53935);
        }
        
        .create-match {
            margin-top: 20px;
            text-align: center;
        }
        
        .create-btn {
            padding: 12px 30px;
            background: linear-gradient(90deg, #2196F3, #1976D2);
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .create-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(33, 150, 243, 0.4);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .user-welcome {
            font-size: 18px;
        }
        
        .logout-btn {
            padding: 8px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .logout-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        /* Chat Sistemi */
        .chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .chat-header {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            font-weight: 600;
            text-align: center;
        }
        
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
            display: flex;
            flex-direction: column;
        }
        
        .chat-message {
            margin-bottom: 10px;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            max-width: 100%;
            word-wrap: break-word;
        }
        
        .chat-message .sender {
            font-weight: bold;
            color: #ff8a00;
            margin-right: 5px;
        }
        
        .chat-input {
            display: flex;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            gap: 10px;
        }
        
        .chat-input input {
            flex: 1;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            color: white;
        }
        
        .chat-input button {
            padding: 10px 15px;
            background: #4CAF50;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            white-space: nowrap;
        }
        
        /* CoinFlip Animasyonu */
        .coinflip-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            display: none;
        }
        
        .coinflip-content {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            max-width: 500px;
            width: 90%;
        }
        
        .coin {
            width: 150px;
            height: 150px;
            margin: 20px auto;
            position: relative;
            transform-style: preserve-3d;
        }
        
        .coin .front, .coin .back {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            backface-visibility: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            font-weight: bold;
        }
        
        .coin .front {
            background: linear-gradient(45deg, #ff8a00, #e52e71);
        }
        
        .coin .back {
            background: linear-gradient(45deg, #2196F3, #1976D2);
            transform: rotateY(180deg);
        }
        
        .flipping {
            animation: flip 2s infinite;
        }
        
        @keyframes flip {
            0% { transform: rotateY(0); }
            50% { transform: rotateY(1800deg); }
            100% { transform: rotateY(3600deg); }
        }
        
        .result {
            margin-top: 20px;
            font-size: 24px;
            font-weight: bold;
        }
        
        .winner {
            color: #4CAF50;
        }
        
        .loser {
            color: #f44336;
        }
        
        .no-matches {
            text-align: center;
            padding: 30px;
            color: #aaa;
            grid-column: 1 / -1;
        }
        
        /* Envanter Modal */
        .inventory-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            display: none;
        }
        
        .inventory-content {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .inventory-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .inventory-header h2 {
            font-size: 24px;
        }
        
        .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
        }
        
        .inventory-items {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
        }
        
        .inventory-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }
        
        .inventory-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .inventory-item.selected {
            border-color: #ff8a00;
        }
        
        .item-image {
            width: 80px;
            height: 80px;
            margin: 0 auto 10px;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .item-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .item-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .item-value {
            color: #4CAF50;
            font-size: 14px;
        }
        
        .top-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .top-btn {
            padding: 10px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            text-align: center;
        }
        
        .top-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        /* Withdraw Modal */
        .withdraw-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1001;
            display: none;
        }
        
        .withdraw-content {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            max-width: 400px;
            width: 90%;
        }
        
        .withdraw-item {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px 0;
        }
        
        .withdraw-item-image {
            width: 60px;
            height: 60px;
            border-radius: 10px;
            overflow: hidden;
            margin-right: 15px;
        }
        
        .withdraw-item-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .withdraw-item-info {
            text-align: left;
        }
        
        .withdraw-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .withdraw-buttons button {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            font-weight: 600;
        }
        
        .withdraw-confirm {
            background: #4CAF50;
        }
        
        .withdraw-cancel {
            background: #f44336;
        }
        
        /* Create Match Modal */
        .create-match-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            display: none;
        }
        
        .create-match-content {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
        }
        
        .selected-items-preview {
            margin: 20px 0;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .selected-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            padding: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
        }
        
        .selected-item img {
            width: 40px;
            height: 40px;
            border-radius: 5px;
            margin-right: 10px;
        }
        
        .selected-item-info {
            flex: 1;
        }
        
        .remove-item {
            background: #f44336;
            border: none;
            color: white;
            border-radius: 3px;
            padding: 5px 10px;
            cursor: pointer;
        }
        
        .no-item-selected {
            text-align: center;
            padding: 20px;
            color: #aaa;
        }
        
        .side-selection {
            margin: 20px 0;
            text-align: center;
        }
        
        .side-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .side-btn {
            flex: 1;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid transparent;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .side-btn.selected {
            border-color: #ff8a00;
            background: rgba(255, 138, 0, 0.2);
        }
        
        .side-btn.heads {
            background: linear-gradient(90deg, #ff8a00, #e52e71);
        }
        
        .side-btn.tails {
            background: linear-gradient(90deg, #2196F3, #1976D2);
        }
        
        .total-value {
            text-align: center;
            margin: 15px 0;
            font-size: 18px;
            font-weight: bold;
            color: #4CAF50;
        }
        
        /* Tip Modal */
        .tip-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1001;
            display: none;
        }
        
        .tip-content {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
        }
        
        .tip-form {
            margin: 20px 0;
        }
        
        .tip-form input {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            color: white;
        }
        
        .tip-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .tip-buttons button {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            font-weight: 600;
        }
        
        .tip-confirm {
            background: #4CAF50;
        }
        
        .tip-cancel {
            background: #f44336;
        }
        
        .all-items-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 15px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .quick-tip-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .quick-tip-item:hover {
            transform: translateY(-2px);
            border-color: #ff8a00;
        }
        
        .quick-tip-item.selected {
            border-color: #4CAF50;
        }
        
        .quick-tip-item img {
            width: 50px;
            height: 50px;
            border-radius: 5px;
            margin-bottom: 5px;
        }
        
        .tip-instruction {
            text-align: center;
            color: #aaa;
            font-size: 14px;
            margin: 10px 0;
        }

        /* Baƒülantƒ± Durumu */
        .connection-status {
            position: fixed;
            top: 10px;
            right: 10px;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            z-index: 1000;
        }
        
        .connection-status.connected {
            background: #4CAF50;
            color: white;
        }
        
        .connection-status.disconnected {
            background: #f44336;
            color: white;
        }
    </style>
</head>
<body>
    <!-- Baƒülantƒ± Durumu -->
    <div class="connection-status disconnected" id="connectionStatus">üî¥ √áevrimdƒ±≈üƒ±</div>

    <!-- Giri≈ü Sayfasƒ± -->
    <div class="container" id="loginContainer" style="max-width: 450px; margin: 50px auto;">
        <div class="logo">
            <h1>Dedok Bet</h1>
            <p>Giri≈ü yaparak, en az 18 ya≈üƒ±nda olduƒüunuzu, bahis yaptƒ±ƒüƒ±nƒ±z √∂ƒüelerin √ßalƒ±ntƒ± olmadƒ±ƒüƒ±nƒ± ve Kullanƒ±m ≈ûartlarƒ±mƒ±zƒ± kabul ettiƒüinizi onaylamƒ±≈ü olursunuz.</p>
        </div>
        
        <!-- Adƒ±m 1: Kullanƒ±cƒ± Adƒ± Giri≈üi -->
        <div class="step active" id="step1">
            <div class="form-group">
                <label for="username">Roblox Kullanƒ±cƒ± Adƒ±</label>
                <input type="text" id="username" placeholder="Roblox kullanƒ±cƒ± adƒ±nƒ±zƒ± girin...">
            </div>
            
            <div class="checkbox-group">
                <input type="checkbox" id="terms">
                <label for="terms">Bu kutuyu i≈üaretleyerek ≈üartlar ve hizmetlerimizi kabul etmi≈ü olursunuz</label>
            </div>
            
            <button class="btn" id="loginBtn">Giri≈ü Yap</button>
            <div class="error-message" id="step1Error"></div>
        </div>
        
        <!-- Adƒ±m 2: Doƒürulama Kodu Giri≈üi -->
        <div class="step" id="step2">
            <button class="btn back-button" id="backBtn">‚Üê Geri</button>
            
            <div class="verification-info">
                <p><strong id="usernameDisplay"></strong> kullanƒ±cƒ± adƒ± i√ßin doƒürulama gerekiyor.</p>
                <p>L√ºtfen a≈üaƒüƒ±daki kodu kopyalayƒ±p Roblox profil a√ßƒ±klamanƒ±za yapƒ±≈ütƒ±rƒ±n:</p>
                <div class="verification-code" id="verificationCodeDisplay">Y√ºkleniyor...</div>
                <p>Kodu a√ßƒ±klamanƒ±za ekledikten sonra a≈üaƒüƒ±daki butona tƒ±klayƒ±n.</p>
            </div>
            
            <button class="btn" id="verifyBtn">Doƒürulamayƒ± Tamamladƒ±m</button>
            <div class="error-message" id="step2Error"></div>
        </div>
    </div>

    <!-- Ana Uygulama -->
    <div class="app-container" id="appContainer" style="display: none;">
        <!-- Sol Sidebar - Chat -->
        <div class="sidebar">
            <div class="container">
                <div class="chat-container">
                    <div class="chat-header">Genel Sohbet</div>
                    <div class="chat-messages" id="chatMessages">
                        <div class="chat-message">
                            <span class="sender">Sistem:</span> Sohbete ho≈ü geldiniz! /tip [kullanƒ±cƒ±] [item] komutu ile item g√∂nderebilirsiniz.
                        </div>
                    </div>
                    <div class="chat-input">
                        <input type="text" id="chatInput" placeholder="Mesajƒ±nƒ±zƒ± yazƒ±n...">
                        <button id="sendMessageBtn">G√∂nder</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ana ƒ∞√ßerik - CoinFlip -->
        <div class="main-content">
            <div class="container coinflip-container" id="coinflipContainer">
                <div class="coinflip-header">
                    <h1>Dedok Bet - CoinFlip</h1>
                    <p>Risk al, kazan√ßlarƒ± topla! %50 ≈üans ile paranƒ± ikiye katla.</p>
                </div>
                
                <div class="user-info">
                    <div class="user-welcome">Ho≈ü geldin, <strong id="coinflipUsername"></strong>!</div>
                    <button class="logout-btn" id="logoutBtn">√áƒ±kƒ±≈ü Yap</button>
                </div>
                
                <div class="top-buttons">
                    <button class="top-btn" id="walletBtn">üí∞ Wallet</button>
                </div>
                
                <div class="balance-card">
                    <div>
                        <h3>Toplam Value</h3>
                        <div class="balance-amount" id="userBalance">0 Value</div>
                    </div>
                </div>
                
                <h2 style="margin-bottom: 15px;">Aktif Ma√ßlar</h2>
                <div class="matches-container" id="matchesContainer">
                    <div class="no-matches" id="noMatchesMessage">
                        Hen√ºz aktif ma√ß bulunmuyor. ƒ∞lk ma√ßƒ± siz olu≈üturun!
                    </div>
                </div>
                
                <div class="create-match">
                    <button class="create-btn" id="createMatchBtn">Yeni Ma√ß Olu≈ütur</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal'lar -->
    <!-- CoinFlip Animasyon Modal -->
    <div class="coinflip-modal" id="coinflipModal">
        <div class="coinflip-content">
            <h2>CoinFlip</h2>
            <div class="coin" id="coin">
                <div class="front">HEADS</div>
                <div class="back">TAILS</div>
            </div>
            <div class="result" id="coinflipResult"></div>
            <button class="btn" id="closeModalBtn" style="margin-top: 20px;">Kapat</button>
        </div>
    </div>

    <!-- Envanter Modal -->
    <div class="inventory-modal" id="inventoryModal">
        <div class="inventory-content">
            <div class="inventory-header">
                <h2>Envanterim</h2>
                <button class="close-btn" id="closeInventoryBtn">√ó</button>
            </div>
            <div class="inventory-items" id="inventoryItems">
                <!-- Itemler buraya eklenecek -->
            </div>
        </div>
    </div>

    <!-- Withdraw Modal -->
    <div class="withdraw-modal" id="withdrawModal">
        <div class="withdraw-content">
            <h2>Item'i Withdraw Et</h2>
            <div class="withdraw-item" id="withdrawItemInfo">
                <!-- Item bilgisi buraya eklenecek -->
            </div>
            <p>Bu item'i withdraw etmek istediƒüinizden emin misiniz?</p>
            <p style="color: #ff8a00; margin: 10px 0;">≈ûu anda yapƒ±m a≈üamasƒ±nda. Discord √ºzerinden moderat√∂rle ileti≈üime ge√ßin.</p>
            <div class="withdraw-buttons">
                <button class="withdraw-confirm" id="confirmWithdrawBtn">Evet</button>
                <button class="withdraw-cancel" id="cancelWithdrawBtn">Hayƒ±r</button>
            </div>
        </div>
    </div>

    <!-- Create Match Modal -->
    <div class="create-match-modal" id="createMatchModal">
        <div class="create-match-content">
            <div class="inventory-header">
                <h2>Ma√ß ƒ∞√ßin Item Se√ßin</h2>
                <button class="close-btn" id="closeCreateMatchBtn">√ó</button>
            </div>
            
            <div class="selected-items-preview" id="selectedItemsPreview">
                <div class="no-item-selected">Hen√ºz item se√ßilmedi</div>
            </div>
            
            <div class="total-value" id="totalMatchValue">Toplam Value: 0</div>
            
            <div class="side-selection">
                <h3>Heads or Tails Se√ßin</h3>
                <div class="side-buttons">
                    <button class="side-btn heads" data-side="heads">HEADS</button>
                    <button class="side-btn tails" data-side="tails">TAILS</button>
                </div>
            </div>
            
            <div class="inventory-items" id="createMatchItems">
                <!-- Itemler buraya eklenecek -->
            </div>
            
            <button class="btn" id="confirmCreateMatchBtn" style="margin-top: 20px;" disabled>Ma√ßƒ± Olu≈ütur</button>
        </div>
    </div>

    <!-- Tip Modal -->
    <div class="tip-modal" id="tipModal">
        <div class="tip-content">
            <div class="inventory-header">
                <h2>Item G√∂nder</h2>
                <button class="close-btn" id="closeTipBtn">√ó</button>
            </div>
            
            <div class="tip-form">
                <input type="text" id="tipUsername" placeholder="Kullanƒ±cƒ± adƒ±">
                <div class="selected-items-preview" id="tipItemsPreview">
                    <div class="no-item-selected">Hen√ºz item se√ßilmedi</div>
                </div>
                <div class="total-value" id="totalTipValue">Toplam Value: 0</div>
                
                <div class="tip-instruction">
                    T√ºm itemlerden se√ßim yapabilirsiniz (envanterinizde olmasƒ± gerekmez)
                </div>
                
                <div class="all-items-grid" id="allItemsGrid">
                    <!-- T√ºm itemler buraya eklenecek -->
                </div>
            </div>
            
            <div class="tip-buttons">
                <button class="tip-confirm" id="confirmTipBtn">G√∂nder</button>
                <button class="tip-cancel" id="cancelTipBtn">ƒ∞ptal</button>
            </div>
        </div>
    </div>

    <script>
        // SUPABASE AYARLARI
        const SUPABASE_URL = 'https://vkuhfhjibegquqatxmyt.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZrdWhmaGppYmVncXVxYXR4bXl0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQzNDEwNzMsImV4cCI6MjA3OTkxNzA3M30.1Ir2Hy43qw6ey59gGytr8Jo3OKUC9y5pt8Jwj76PPPc';

        // Supabase baƒülantƒ±sƒ±
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // Supabase Backend Fonksiyonlarƒ±
        class SupabaseBackend {
            // Kullanƒ±cƒ± kayƒ±t
            static async registerUser(username) {
                const { data, error } = await supabase
                    .from('users')
                    .insert([{ username, inventory: '[]' }])
                    .select();
                
                return { success: !error, user: data ? data[0] : null };
            }

            // Chat mesajƒ± g√∂nder
            static async sendMessage(sender, message) {
                const { error } = await supabase
                    .from('chat_messages')
                    .insert([{ sender, message }]);
                
                return { success: !error };
            }

            // Yeni ma√ß olu≈ütur
            static async createMatch(matchData) {
                // Items'i JSON formatƒ±na √ßevir
                const matchToInsert = {
                    ...matchData,
                    items: JSON.stringify(matchData.items),
                    player2_items: matchData.player2_items ? JSON.stringify(matchData.player2_items) : null
                };
                
                const { data, error } = await supabase
                    .from('matchlist')
                    .insert([matchToInsert])
                    .select();
                
                return { success: !error, match: data ? data[0] : null };
            }

            // T√ºm ma√ßlarƒ± getir
            static async getMatches() {
                const { data, error } = await supabase
                    .from('matchlist')
                    .select('*')
                    .order('created_at', { ascending: false });
                
                if (error) {
                    console.error('Ma√ßlar y√ºklenirken hata:', error);
                    return [];
                }
                
                // JSON verilerini parse et
                return data.map(match => ({
                    ...match,
                    items: match.items ? JSON.parse(match.items) : [],
                    player2_items: match.player2_items ? JSON.parse(match.player2_items) : null
                }));
            }

            // Ma√ßa katƒ±l
            static async joinMatch(matchId, playerData) {
                const { error } = await supabase
                    .from('matchlist')
                    .update({ 
                        player2: playerData.username,
                        player2_items: JSON.stringify(playerData.items),
                        status: 'active'
                    })
                    .eq('id', matchId);
                
                return { success: !error };
            }

            // T√ºm chat mesajlarƒ±nƒ± getir
            static async getChatMessages() {
                const { data, error } = await supabase
                    .from('chat_messages')
                    .select('*')
                    .order('created_at', { ascending: true })
                    .limit(50);
                
                return error ? [] : data;
            }
        }

        // Eski BackendAPI yerine bunu kullan
        const BackendAPI = SupabaseBackend;

        // DOM Elementleri
        const loginContainer = document.getElementById('loginContainer');
        const appContainer = document.getElementById('appContainer');
        const coinflipContainer = document.getElementById('coinflipContainer');
        const step1 = document.getElementById('step1');
        const step2 = document.getElementById('step2');
        const usernameInput = document.getElementById('username');
        const termsCheckbox = document.getElementById('terms');
        const loginBtn = document.getElementById('loginBtn');
        const backBtn = document.getElementById('backBtn');
        const usernameDisplay = document.getElementById('usernameDisplay');
        const verificationCodeDisplay = document.getElementById('verificationCodeDisplay');
        const verifyBtn = document.getElementById('verifyBtn');
        const coinflipUsername = document.getElementById('coinflipUsername');
        const step1Error = document.getElementById('step1Error');
        const step2Error = document.getElementById('step2Error');
        const matchesContainer = document.getElementById('matchesContainer');
        const noMatchesMessage = document.getElementById('noMatchesMessage');
        const logoutBtn = document.getElementById('logoutBtn');
        const createMatchBtn = document.getElementById('createMatchBtn');
        const chatMessages = document.getElementById('chatMessages');
        const chatInput = document.getElementById('chatInput');
        const sendMessageBtn = document.getElementById('sendMessageBtn');
        const coinflipModal = document.getElementById('coinflipModal');
        const coin = document.getElementById('coin');
        const coinflipResult = document.getElementById('coinflipResult');
        const closeModalBtn = document.getElementById('closeModalBtn');
        const walletBtn = document.getElementById('walletBtn');
        const inventoryModal = document.getElementById('inventoryModal');
        const closeInventoryBtn = document.getElementById('closeInventoryBtn');
        const inventoryItems = document.getElementById('inventoryItems');
        const withdrawModal = document.getElementById('withdrawModal');
        const withdrawItemInfo = document.getElementById('withdrawItemInfo');
        const confirmWithdrawBtn = document.getElementById('confirmWithdrawBtn');
        const cancelWithdrawBtn = document.getElementById('cancelWithdrawBtn');
        const createMatchModal = document.getElementById('createMatchModal');
        const closeCreateMatchBtn = document.getElementById('closeCreateMatchBtn');
        const createMatchItems = document.getElementById('createMatchItems');
        const selectedItemsPreview = document.getElementById('selectedItemsPreview');
        const confirmCreateMatchBtn = document.getElementById('confirmCreateMatchBtn');
        const userBalance = document.getElementById('userBalance');
        const totalMatchValue = document.getElementById('totalMatchValue');
        const tipModal = document.getElementById('tipModal');
        const closeTipBtn = document.getElementById('closeTipBtn');
        const tipItemsPreview = document.getElementById('tipItemsPreview');
        const tipUsername = document.getElementById('tipUsername');
        const confirmTipBtn = document.getElementById('confirmTipBtn');
        const cancelTipBtn = document.getElementById('cancelTipBtn');
        const totalTipValue = document.getElementById('totalTipValue');
        const allItemsGrid = document.getElementById('allItemsGrid');
        const connectionStatus = document.getElementById('connectionStatus');
        
        // Deƒüi≈ükenler
        let currentUser = null;
        let verificationCode = '';
        let activeMatches = [];
        let userInventory = [];
        let selectedItemForWithdraw = null;
        let selectedItemsForMatch = [];
        let selectedSideForMatch = null;
        let selectedItemsForTip = [];
        let users = {};

        // Real-time dinleyicileri ba≈ülat
        function initializeRealtimeListeners() {
            console.log('Real-time dinleyiciler ba≈ülatƒ±lƒ±yor...');
            
            // Chat mesajlarƒ± i√ßin real-time dinleyici
            supabase
                .channel('public:chat_messages')
                .on('postgres_changes', 
                    { 
                        event: 'INSERT', 
                        schema: 'public', 
                        table: 'chat_messages' 
                    }, 
                    (payload) => {
                        console.log('Yeni mesaj geldi:', payload);
                        addChatMessage(payload.new.sender, payload.new.message);
                    }
                )
                .subscribe();

            // Ma√ßlar i√ßin real-time dinleyici
            supabase
                .channel('public:matchlist')
                .on('postgres_changes', 
                    { 
                        event: '*', 
                        schema: 'public', 
                        table: 'matchlist' 
                    }, 
                    (payload) => {
                        console.log('Ma√ß deƒüi≈üikliƒüi:', payload);
                        handleMatchChange(payload);
                    }
                )
                .subscribe();
        }

        // Ma√ß deƒüi≈üikliklerini i≈üle
        function handleMatchChange(payload) {
            if (payload.eventType === 'INSERT') {
                // Yeni ma√ß eklendi
                const newMatch = {
                    ...payload.new,
                    items: payload.new.items ? JSON.parse(payload.new.items) : [],
                    player2_items: payload.new.player2_items ? JSON.parse(payload.new.player2_items) : null
                };
                
                if (!activeMatches.some(m => m.id === newMatch.id)) {
                    activeMatches.push(newMatch);
                    updateMatchesDisplay();
                    addChatMessage("Sistem", `${newMatch.creator} yeni bir CoinFlip ma√ßƒ± olu≈üturdu!`);
                }
            } else if (payload.eventType === 'UPDATE') {
                // Ma√ß g√ºncellendi
                const updatedMatch = {
                    ...payload.new,
                    items: payload.new.items ? JSON.parse(payload.new.items) : [],
                    player2_items: payload.new.player2_items ? JSON.parse(payload.new.player2_items) : null
                };
                
                const index = activeMatches.findIndex(m => m.id === updatedMatch.id);
                if (index !== -1) {
                    activeMatches[index] = updatedMatch;
                    updateMatchesDisplay();
                    
                    if (updatedMatch.player2 && !payload.old.player2) {
                        addChatMessage("Sistem", `${updatedMatch.player2} ${updatedMatch.creator}'ƒ±n ma√ßƒ±na katƒ±ldƒ±!`);
                    }
                }
            } else if (payload.eventType === 'DELETE') {
                // Ma√ß silindi
                activeMatches = activeMatches.filter(m => m.id !== payload.old.id);
                updateMatchesDisplay();
            }
        }

        // Chat mesajƒ± ekle
        function addChatMessage(sender, message) {
            const messageElement = document.createElement('div');
            messageElement.className = 'chat-message';
            messageElement.innerHTML = `<span class="sender">${sender}:</span> ${message}`;
            chatMessages.appendChild(messageElement);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Sayfa y√ºklendiƒüinde oturum kontrol√º
        document.addEventListener('DOMContentLoaded', async function() {
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = savedUser;
                userInventory = JSON.parse(localStorage.getItem('userInventory')) || [];
                
                await showMainApp();
            }
        });

        // Item tanƒ±mlarƒ±
        const items = [
            {
                id: 1,
                name: "Corrupt",
                value: 825,
                image: "https://tr.rbxcdn.com/180DAY-f3a3fda528c91ef9357361df1c14d5fb/420/420/Model/Png/noFilter"
            },
            {
                id: 2,
                name: "C Vampires Gun",
                value: 23000,
                image: "https://tr.rbxcdn.com/180DAY-7ecc9d172ad05caf211e515471893d29/420/420/Image/Png/noFilter"
            },
            {
                id: 3,
                name: "Travellers Gun",
                value: 4100,
                image: "https://tr.rbxcdn.com/180DAY-950f9412ff516bbea7459c4ba504d4a2/420/420/Model/Png/noFilter"
            },
            {
                id: 4,
                name: "Evergun",
                value: 3000,
                image: "https://tr.rbxcdn.com/180DAY-50bb023f54e8dbae44aa4b02d61ce050/420/420/Image/Png/noFilter"
            },
            {
                id: 5,
                name: "Sugar",
                value: 70,
                image: "https://tr.rbxcdn.com/180DAY-fc538eca64fbe088a13c8ce66e47a0a2/420/420/Image/Png/noFilter"
            },
            {
                id: 6,
                name: "Vampires Gun",
                value: 2000,
                image: "https://tr.rbxcdn.com/180DAY-a132d04b779839721744cd1f31c2ec39/420/420/Model/Png/noFilter"
            },
            {
                id: 7,
                name: "Harvester",
                value: 450,
                image: "https://tr.rbxcdn.com/180DAY-67a3a4b144ccf57f1bbdafe8fa27a08a/420/420/Model/Png/noFilter"
            },
            {
                id: 8,
                name: "Sakura",
                value: 895,
                image: "https://tr.rbxcdn.com/180DAY-f1d1285a9c3c4de680df8a5ae9fe2af9/420/420/Model/Png/noFilter"
            },
            {
                id: 9,
                name: "Icepiercer",
                value: 325,
                image: "https://tr.rbxcdn.com/180DAY-6213a4bb141ead4f941b11a0f93fd44a/420/420/Model/Png/noFilter"
            },
            {
                id: 10,
                name: "Chroma Saw",
                value: 40,
                image: "https://tr.rbxcdn.com/180DAY-ffd5ea6a2617d24536ff6adf87c0bbd1/420/420/Image/Png/noFilter"
            },
            {
                id: 11,
                name: "Candy",
                value: 170,
                image: "https://tr.rbxcdn.com/180DAY-2007a4c9c774eb21534ed011ae6e36b2/420/420/Model/Png/noFilter"
            },
            {
                id: 12,
                name: "Chroma Gemstone",
                value: 45,
                image: "https://tr.rbxcdn.com/180DAY-cd9724ce67d6854fdd9dc219eb3e0ac2/420/420/Image/Png/noFilter"
            },
            {
                id: 13,
                name: "Chroma Heat",
                value: 45,
                image: "https://tr.rbxcdn.com/180DAY-292d5d05d6c42cb1f413b2b8ab2be5e1/420/420/Image/Png/noFilter"
            },
            {
                id: 14,
                name: "Chroma Seer",
                value: 45,
                image: "https://tr.rbxcdn.com/180DAY-468b0f806c05652ed9b7a3a09a45edc0/420/420/Image/Png/noFilter"
            },
            {
                id: 15,
                name: "Chroma Boneblade",
                value: 40,
                image: "https://tr.rbxcdn.com/180DAY-c0b2f2255317bee86c95e70626ee2aa5/420/420/Model/Png/noFilter"
            },
            {
                id: 16,
                name: "Rainbow Gun",
                value: 250,
                image: "https://tr.rbxcdn.com/180DAY-4644f803d4c1171db843b608d8692354/420/420/Model/Png/noFilter"
            },
            {
                id: 17,
                name: "Flowerwood Gun",
                value: 150,
                image: "https://tr.rbxcdn.com/180DAY-d321727e99eb67e54c746a2c310b0472/420/420/Model/Png/noFilter"
            }
        ];
        
        // Giri≈ü butonu tƒ±klama olayƒ±
        loginBtn.addEventListener('click', function() {
            const username = usernameInput.value.trim();
            
            // Doƒürulamalar
            if (!username) {
                showError(step1Error, "L√ºtfen Roblox kullanƒ±cƒ± adƒ±nƒ±zƒ± girin.");
                return;
            }
            
            if (!termsCheckbox.checked) {
                showError(step1Error, "Devam etmek i√ßin ≈üartlarƒ± kabul etmelisiniz.");
                return;
            }
            
            // Hata mesajƒ±nƒ± temizle
            hideError(step1Error);
            
            // Kullanƒ±cƒ± adƒ±nƒ± g√∂ster ve doƒürulama kodu olu≈ütur
            usernameDisplay.textContent = username;
            generateVerificationCode();
            showStep(2);
        });
        
        // Doƒürulama kodu olu≈üturma
        function generateVerificationCode() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let code = '';
            for (let i = 0; i < 8; i++) {
                code += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            verificationCode = code;
            verificationCodeDisplay.textContent = code;
        }
        
        // Geri butonu tƒ±klama olayƒ±
        backBtn.addEventListener('click', function() {
            showStep(1);
        });
        
        // Doƒürulama butonu tƒ±klama olayƒ±
        verifyBtn.addEventListener('click', async function() {
            // Ger√ßek uygulamada burada Roblox API ile a√ßƒ±klama kontrol√º yapƒ±lmalƒ±
            // Bu √∂rnekte doƒürulamayƒ± atlƒ±yoruz
            
            // Hata mesajƒ±nƒ± temizle
            hideError(step2Error);
            
            // Ba≈üarƒ±lƒ± giri≈ü
            currentUser = usernameInput.value.trim();
            userInventory = [];
            
            localStorage.setItem('currentUser', currentUser);
            localStorage.setItem('userInventory', JSON.stringify(userInventory));
            
            await showMainApp();
        });

        // Ana uygulamayƒ± g√∂ster
        async function showMainApp() {
            loginContainer.style.display = 'none';
            appContainer.style.display = 'flex';
            coinflipContainer.style.display = 'flex';
            coinflipUsername.textContent = currentUser;
            
            try {
                // Mevcut ma√ßlarƒ± y√ºkle
                const matches = await BackendAPI.getMatches();
                activeMatches = matches;
                updateMatchesDisplay();
                
                // Mevcut chat mesajlarƒ±nƒ± y√ºkle
                const chatMessagesData = await BackendAPI.getChatMessages();
                chatMessages.innerHTML = '';
                chatMessagesData.forEach(msg => {
                    addChatMessage(msg.sender, msg.message);
                });
                
                // Real-time dinleyicileri ba≈ülat
                initializeRealtimeListeners();
                
                // Baƒülantƒ± durumunu g√ºncelle
                connectionStatus.textContent = 'üü¢ √áevrimi√ßi';
                connectionStatus.className = 'connection-status connected';
                
                loadAllItemsForTip();
                
                console.log('Uygulama ba≈ülatƒ±ldƒ±:', { currentUser, matchesCount: activeMatches.length });
            } catch (error) {
                console.error('Uygulama ba≈ülatƒ±lƒ±rken hata:', error);
            }
        }

        // Mesaj g√∂nderme
        sendMessageBtn.addEventListener('click', sendMessage);
        chatInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        async function sendMessage() {
            const message = chatInput.value.trim();
            if (message && currentUser) {
                if (message.startsWith('/tip ')) {
                    const parts = message.split(' ');
                    if (parts.length >= 3) {
                        const targetUser = parts[1];
                        const itemName = parts.slice(2).join(' ');
                        const itemToTip = items.find(item => 
                            item.name.toLowerCase() === itemName.toLowerCase()
                        );
                        
                        if (itemToTip) {
                            showTipModal(targetUser, [itemToTip]);
                        } else {
                            addChatMessage("Sistem", "Item bulunamadƒ±!");
                        }
                    } else {
                        addChatMessage("Sistem", "Kullanƒ±m: /tip [kullanƒ±cƒ±] [item]");
                    }
                } else {
                    // Mesajƒ± Supabase'e kaydet
                    const result = await BackendAPI.sendMessage(currentUser, message);
                    if (!result.success) {
                        addChatMessage("Sistem", "Mesaj g√∂nderilemedi!");
                    }
                }
                chatInput.value = '';
            }
        }

        // Ma√ß olu≈üturma onayƒ±
        confirmCreateMatchBtn.addEventListener('click', async function() {
            if (selectedItemsForMatch.length > 0 && selectedSideForMatch) {
                const totalValue = selectedItemsForMatch.reduce((total, item) => total + item.value, 0);
                
                const newMatch = {
                    creator: currentUser,
                    player2: null,
                    items: [...selectedItemsForMatch],
                    side: selectedSideForMatch,
                    totalValue: totalValue,
                    pot: totalValue * 2,
                    status: 'waiting'
                };
                
                // Ma√ßƒ± Supabase'e kaydet
                const result = await BackendAPI.createMatch(newMatch);
                
                if (result.success) {
                    // Ma√ß real-time olarak diƒüer kullanƒ±cƒ±lara iletilecek
                    console.log('Ma√ß olu≈üturuldu:', result.match);
                    
                    // Se√ßilen itemleri envanterden kaldƒ±r
                    selectedItemsForMatch.forEach(item => {
                        userInventory = userInventory.filter(invItem => invItem.id !== item.id);
                    });
                    updateTotalValue();
                    
                    localStorage.setItem('userInventory', JSON.stringify(userInventory));
                    
                    createMatchModal.style.display = 'none';
                } else {
                    alert("Ma√ß olu≈üturulurken hata olu≈ütu!");
                }
            }
        });

        // Yardƒ±mcƒ± Fonksiyonlar
        function showStep(stepNumber) {
            document.querySelectorAll('.step').forEach(step => {
                step.classList.remove('active');
            });
            document.getElementById('step' + stepNumber).classList.add('active');
        }

        function showError(errorElement, message) {
            errorElement.textContent = message;
            errorElement.style.display = 'block';
        }

        function hideError(errorElement) {
            errorElement.style.display = 'none';
        }

        function updateTotalValue() {
            const total = userInventory.reduce((sum, item) => sum + item.value, 0);
            userBalance.textContent = total + ' Value';
        }

        // Ma√ßlarƒ± g√ºncelle
        function updateMatchesDisplay() {
            matchesContainer.innerHTML = '';
            
            if (activeMatches.length === 0) {
                noMatchesMessage.style.display = 'block';
                return;
            }
            
            noMatchesMessage.style.display = 'none';
            
            activeMatches.forEach(match => {
                const matchCard = document.createElement('div');
                matchCard.className = 'match-card';
                
                const totalValue = match.items.reduce((sum, item) => sum + item.value, 0);
                
                matchCard.innerHTML = `
                    <div class="match-header">
                        <div class="match-id">${match.id}</div>
                        <div class="match-pot">${totalValue * 2} Value</div>
                    </div>
                    <div class="players">
                        <div class="player">
                            <div class="player-name">${match.creator}</div>
                            <div class="player-avatar">${match.creator.charAt(0)}</div>
                            <div class="player-bet">${totalValue} Value</div>
                        </div>
                        <div class="player">
                            <div class="player-name">${match.player2 || 'Bekleniyor'}</div>
                            <div class="player-avatar">${match.player2 ? match.player2.charAt(0) : '?'}</div>
                            <div class="player-bet">${match.player2 ? (match.player2_items ? match.player2_items.reduce((sum, item) => sum + item.value, 0) : 0) + ' Value' : ''}</div>
                        </div>
                    </div>
                    <button class="join-btn" ${match.creator === currentUser || match.player2 ? 'disabled' : ''}>
                        ${match.creator === currentUser ? 'Sizin Ma√ßƒ±nƒ±z' : (match.player2 ? 'Ma√ß Dolu' : 'Katƒ±l')}
                    </button>
                `;
                
                const joinBtn = matchCard.querySelector('.join-btn');
                if (!joinBtn.disabled) {
                    joinBtn.addEventListener('click', () => joinMatch(match.id));
                }
                
                matchesContainer.appendChild(matchCard);
            });
        }

        // Ma√ßa katƒ±l
        async function joinMatch(matchId) {
            const match = activeMatches.find(m => m.id === matchId);
            if (!match) return;
            
            // Kullanƒ±cƒ±nƒ±n envanterini g√∂ster
            showInventoryForMatch(matchId);
        }

        // Envanteri g√∂ster (ma√ß i√ßin)
        function showInventoryForMatch(matchId) {
            inventoryItems.innerHTML = '';
            
            if (userInventory.length === 0) {
                inventoryItems.innerHTML = '<div style="text-align: center; padding: 20px; color: #aaa;">Envanteriniz bo≈ü</div>';
                return;
            }
            
            userInventory.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'inventory-item';
                itemElement.innerHTML = `
                    <div class="item-image">
                        <img src="${item.image}" alt="${item.name}">
                    </div>
                    <div class="item-name">${item.name}</div>
                    <div class="item-value">${item.value} Value</div>
                `;
                
                itemElement.addEventListener('click', () => {
                    // Item se√ßimi burada yapƒ±lacak
                    selectItemForMatch(item, matchId);
                });
                
                inventoryItems.appendChild(itemElement);
            });
            
            inventoryModal.style.display = 'flex';
        }

        function selectItemForMatch(item, matchId) {
            // Bu fonksiyon ma√ßa katƒ±lmak i√ßin item se√ßimini y√∂netecek
            console.log('Item selected for match:', item, matchId);
            // Burada ma√ßa katƒ±lma i≈ülemini tamamlayacak kod olacak
        }

        // T√ºm itemleri y√ºkle (tip i√ßin)
        function loadAllItemsForTip() {
            allItemsGrid.innerHTML = '';
            
            items.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'quick-tip-item';
                itemElement.innerHTML = `
                    <img src="${item.image}" alt="${item.name}">
                    <div>${item.name}</div>
                    <div style="color: #4CAF50; font-size: 12px;">${item.value} Value</div>
                `;
                
                itemElement.addEventListener('click', () => {
                    itemElement.classList.toggle('selected');
                    
                    if (itemElement.classList.contains('selected')) {
                        selectedItemsForTip.push(item);
                    } else {
                        selectedItemsForTip = selectedItemsForTip.filter(i => i.id !== item.id);
                    }
                    
                    updateTipPreview();
                });
                
                allItemsGrid.appendChild(itemElement);
            });
        }

        function updateTipPreview() {
            tipItemsPreview.innerHTML = '';
            
            if (selectedItemsForTip.length === 0) {
                tipItemsPreview.innerHTML = '<div class="no-item-selected">Hen√ºz item se√ßilmedi</div>';
                totalTipValue.textContent = 'Toplam Value: 0';
                return;
            }
            
            let totalValue = 0;
            selectedItemsForTip.forEach(item => {
                totalValue += item.value;
                
                const selectedItem = document.createElement('div');
                selectedItem.className = 'selected-item';
                selectedItem.innerHTML = `
                    <img src="${item.image}" alt="${item.name}">
                    <div class="selected-item-info">
                        <div>${item.name}</div>
                        <div style="color: #4CAF50; font-size: 12px;">${item.value} Value</div>
                    </div>
                    <button class="remove-item" data-id="${item.id}">√ó</button>
                `;
                
                tipItemsPreview.appendChild(selectedItem);
            });
            
            totalTipValue.textContent = `Toplam Value: ${totalValue}`;
            
            // Remove butonlarƒ±na event listener ekle
            tipItemsPreview.querySelectorAll('.remove-item').forEach(btn => {
                btn.addEventListener('click', function() {
                    const itemId = parseInt(this.getAttribute('data-id'));
                    selectedItemsForTip = selectedItemsForTip.filter(item => item.id !== itemId);
                    updateTipPreview();
                    
                    // Grid'deki se√ßimi de kaldƒ±r
                    allItemsGrid.querySelectorAll('.quick-tip-item').forEach(gridItem => {
                        if (gridItem.querySelector('div').textContent === items.find(i => i.id === itemId)?.name) {
                            gridItem.classList.remove('selected');
                        }
                    });
                });
            });
        }

        // Tip modalƒ±nƒ± g√∂ster
        function showTipModal(targetUser = '', preSelectedItems = []) {
            tipUsername.value = targetUser;
            selectedItemsForTip = [...preSelectedItems];
            updateTipPreview();
            
            // Grid'deki se√ßimleri g√ºncelle
            allItemsGrid.querySelectorAll('.quick-tip-item').forEach(item => {
                const itemName = item.querySelector('div').textContent;
                const isSelected = selectedItemsForTip.some(selected => selected.name === itemName);
                item.classList.toggle('selected', isSelected);
            });
            
            tipModal.style.display = 'flex';
        }

        // Event Listeners
        createMatchBtn.addEventListener('click', function() {
            selectedItemsForMatch = [];
            selectedSideForMatch = null;
            updateCreateMatchPreview();
            loadInventoryForMatchCreation();
            createMatchModal.style.display = 'flex';
        });

        closeCreateMatchBtn.addEventListener('click', function() {
            createMatchModal.style.display = 'none';
        });

        closeTipBtn.addEventListener('click', function() {
            tipModal.style.display = 'none';
        });

        cancelTipBtn.addEventListener('click', function() {
            tipModal.style.display = 'none';
        });

        // √áƒ±kƒ±≈ü butonu
        logoutBtn.addEventListener('click', function() {
            localStorage.removeItem('currentUser');
            localStorage.removeItem('userInventory');
            appContainer.style.display = 'none';
            loginContainer.style.display = 'block';
            showStep(1);
            usernameInput.value = '';
            termsCheckbox.checked = false;
            activeMatches = [];
            currentUser = null;
            userInventory = [];
            updateTotalValue();
        });

        // Diƒüer fonksiyonlar
        function loadInventoryForMatchCreation() {
            createMatchItems.innerHTML = '';
            
            if (userInventory.length === 0) {
                createMatchItems.innerHTML = '<div style="text-align: center; padding: 20px; color: #aaa;">Envanteriniz bo≈ü</div>';
                return;
            }
            
            userInventory.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'inventory-item';
                itemElement.innerHTML = `
                    <div class="item-image">
                        <img src="${item.image}" alt="${item.name}">
                    </div>
                    <div class="item-name">${item.name}</div>
                    <div class="item-value">${item.value} Value</div>
                `;
                
                itemElement.addEventListener('click', () => {
                    // Item se√ßimi
                    const isSelected = selectedItemsForMatch.some(selected => selected.id === item.id);
                    if (isSelected) {
                        selectedItemsForMatch = selectedItemsForMatch.filter(selected => selected.id !== item.id);
                        itemElement.classList.remove('selected');
                    } else {
                        selectedItemsForMatch.push(item);
                        itemElement.classList.add('selected');
                    }
                    updateCreateMatchPreview();
                });
                
                createMatchItems.appendChild(itemElement);
            });
        }

        function updateCreateMatchPreview() {
            selectedItemsPreview.innerHTML = '';
            
            if (selectedItemsForMatch.length === 0) {
                selectedItemsPreview.innerHTML = '<div class="no-item-selected">Hen√ºz item se√ßilmedi</div>';
                totalMatchValue.textContent = 'Toplam Value: 0';
                confirmCreateMatchBtn.disabled = true;
                return;
            }
            
            let totalValue = 0;
            selectedItemsForMatch.forEach(item => {
                totalValue += item.value;
                
                const selectedItem = document.createElement('div');
                selectedItem.className = 'selected-item';
                selectedItem.innerHTML = `
                    <img src="${item.image}" alt="${item.name}">
                    <div class="selected-item-info">
                        <div>${item.name}</div>
                        <div style="color: #4CAF50; font-size: 12px;">${item.value} Value</div>
                    </div>
                    <button class="remove-item" data-id="${item.id}">√ó</button>
                `;
                
                selectedItemsPreview.appendChild(selectedItem);
            });
            
            totalMatchValue.textContent = `Toplam Value: ${totalValue}`;
            confirmCreateMatchBtn.disabled = !selectedSideForMatch;
            
            // Remove butonlarƒ±na event listener ekle
            selectedItemsPreview.querySelectorAll('.remove-item').forEach(btn => {
                btn.addEventListener('click', function() {
                    const itemId = parseInt(this.getAttribute('data-id'));
                    selectedItemsForMatch = selectedItemsForMatch.filter(item => item.id !== itemId);
                    updateCreateMatchPreview();
                    
                    // Grid'deki se√ßimi de kaldƒ±r
                    createMatchItems.querySelectorAll('.inventory-item').forEach(invItem => {
                        if (invItem.querySelector('.item-name').textContent === items.find(i => i.id === itemId)?.name) {
                            invItem.classList.remove('selected');
                        }
                    });
                });
            });
        }

        // Side se√ßimi
        document.querySelectorAll('.side-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.side-btn').forEach(b => b.classList.remove('selected'));
                this.classList.add('selected');
                selectedSideForMatch = this.getAttribute('data-side');
                confirmCreateMatchBtn.disabled = selectedItemsForMatch.length === 0;
            });
        });

        // Wallet butonu
        walletBtn.addEventListener('click', function() {
            showInventory();
        });

        function showInventory() {
            inventoryItems.innerHTML = '';
            
            if (userInventory.length === 0) {
                inventoryItems.innerHTML = '<div style="text-align: center; padding: 20px; color: #aaa;">Envanteriniz bo≈ü</div>';
            } else {
                userInventory.forEach(item => {
                    const itemElement = document.createElement('div');
                    itemElement.className = 'inventory-item';
                    itemElement.innerHTML = `
                        <div class="item-image">
                            <img src="${item.image}" alt="${item.name}">
                        </div>
                        <div class="item-name">${item.name}</div>
                        <div class="item-value">${item.value} Value</div>
                    `;
                    
                    itemElement.addEventListener('click', () => {
                        showWithdrawModal(item);
                    });
                    
                    inventoryItems.appendChild(itemElement);
                });
            }
            
            inventoryModal.style.display = 'flex';
        }

        function showWithdrawModal(item) {
            selectedItemForWithdraw = item;
            withdrawItemInfo.innerHTML = `
                <div class="withdraw-item-image">
                    <img src="${item.image}" alt="${item.name}">
                </div>
                <div class="withdraw-item-info">
                    <div style="font-weight: bold;">${item.name}</div>
                    <div style="color: #4CAF50;">${item.value} Value</div>
                </div>
            `;
            withdrawModal.style.display = 'flex';
        }

        closeInventoryBtn.addEventListener('click', function() {
            inventoryModal.style.display = 'none';
        });

        confirmWithdrawBtn.addEventListener('click', function() {
            // Withdraw i≈ülemi - ≈üu anda yapƒ±m a≈üamasƒ±nda
            alert('Withdraw i≈ülemi ≈üu anda yapƒ±m a≈üamasƒ±nda. Discord √ºzerinden moderat√∂rle ileti≈üime ge√ßin.');
            withdrawModal.style.display = 'none';
            inventoryModal.style.display = 'none';
        });

        cancelWithdrawBtn.addEventListener('click', function() {
            withdrawModal.style.display = 'none';
        });

        // ƒ∞lk y√ºkleme
        updateTotalValue();
    </script>
</body>
</html>
